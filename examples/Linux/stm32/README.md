Этот пример показывает фаззинг встраиваемого ПО архитектуры ARM
на основе частичной эмуляции с помощью модифицированной QEMU и скриптов на языке Lua.

В поддиректории `firmware` находится тестируемое ПО (исходный и бинарный код),

В поддиректории `testing` - скрипты и материалы для запуска частичной эмуляции и фаззинга.

# Сборка
```bash
cd firmware
make
cd ..
```

В ходе эмуляции выполняется функция `func` (`src/main.c`)

# Запуск фаззинга
Выполните команды (укажите актуальный путь до `fuzz_manager`)
```bash
cd testing
./startFuzz.sh /path/to/crusher/bin_x86-64/fuzz_manager
```

# Мониторинг фаззинга
Запустить в другом терминале UI фаззера:
```bash
/path/to/crusher/bin_x86-64/ui -o out
```

В правом верхнем углу окна пользовательского интерфейса можно наблюдать окно `Stats`. В нём обратите внимание на поле `unique_crashes`.
Как только будет найдено аварийное завершение, значение поля `unique_crashes` станет ненулевым. Пока значение поля нулевое - не останавливайте фаззинг.
Желательно дождаться, когда значение поля будет больше 1. После этого можно остановить фаззинг:

* в терминале с `UI` (пользовательский интерфейс) - для выхода из `UI` нажмите кнопку `q`;
* в терминале с запущенным фаззингом завершите фаззинг по комбинации клавиш `Ctrl+C`.

# Воспроизведение аварийного завершения
1) Получить список креш-файлов:
```bash
find out -name id_crash_*
```

2) Записать один из креш-файлов, например `out/FUZZ-MASTER_0/crashes/id_crash_0`, в файл `input` и запустите эмуляцию с помощью скрипта `startEmulate.sh`,
подав ему в качестве аргумента путь до исполняемого файла `Qemu` из релиза `Crusher`:

```bash
./startEmulate.sh /path/to/crusher/bin_x86-64/QemuIntegrationTools/QemuArmVanilla/qemu-system-arm
```

3) В случае аварийного завершения, т.е. при возникновении исключения, будет напечатана информация об этом исключении:
слово `"Exception"`, значения регистров в этот момент и т.п.

Более подробное описание отчёта об исключении см. в документации `Crusher`.
